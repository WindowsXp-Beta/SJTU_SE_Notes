[toc]
# chapter2

## 整数

### 补码

two's complement

### 转换

无符号数转为补码
当无符号数大于补码最大值时：u => u - $2^w$
补码转为无符号数
补码小于0时：u => u + $2^w$

### (un)signed number in C

当执行一个运算时，如果它的一个运算数是有符号的而另一个是无符号的，那么C语言会隐式地将有符号数强制类型转换为无符号数，并假设这两个数都是非负的。

### 位数扩展

无符号数拓展：高位补0
补码的拓展：符号扩展

>移位运算符 左移统一补0
右移 对于无符号数，采用逻辑右移，即补0
对于补码，采用算术右移，即符号扩展

> attention
> (unsigned int) short_t <=> (unsigned int)(int) short_t
> 这种既改变大小又改变符号的强制类型转换 是先改变大小再改变符号的。位数扩展时要当心。
### 截断

无符号数截断为w位 u => u mod $2^w$
补码截断为w位 u => U2T( u mod $2^w$ ) 即先执行无符号截断再转换

### 无符号数加法

define: $+_w^u$ 把整数和$x+y$截断为$w$位的结果
$x + y$ 溢出时为 $x + y - 2^w$

模数加法：$x+y=(x+y)$ mod $2^w$

检测无符号数加法中的溢出：
$s = x + y$
当且仅当 $s<x$ or $y$ 时溢出

>模数加法构成了阿贝尔群，而对于每个值$x$，必然有某个值$-^u_wx$满足$-^u_wx+^u_wx=0$

无符号逆元$-_w^ux$为：
$x$ if(x=0) 
$2^w - x$  if(x>0)

### 补码加法

正溢出：两个正数相加大于最大值
$x + y - 2^w$
负溢出：两个负数相加小于最小值
$x+y+2^w$
检测补码加法中的溢出
正溢出：$x>0,y>0\quad \&\& \quad s\le0$
负溢出：$x<0,y<0\quad \&\& \quad s\ge0$
补码的非$-^t_wx$为：
$Tmin_w$  (if x=Tmin_w)
$-x$  (if x>Tmin_w)

>求位级补码非时的两种方法
>1. -x => ~x+1
>2. 设k为x非0的最右边的位，即$x=[x_{w-1}, x_{w-2}, ...1,0,...0 ]$则-x => x=[ ~ x_{w-1}, ~ x_{w-2}, ...1,0,...0 ]

### 减法

众所周知 *减是加的逆运算*，因此理论上只要有了加法，减法就自然而然了。因此：
$x-y<=>x+(-y)$
无符号与有符号的区别：因为**C中的运算都是针对 位 的，而有无符号只是对位的解释不同而已** 
而 $-y$ 的位的表示是按照补码的，因此无符号下该值是十分大的，当 $x<y$ 时，$x+(-y)$便会溢出

### 除法



## 浮点数

### 二进制小数

二进制点左边的数字的权形如 $2^i$，右边的数字的权形如 $\frac{1}{2^i}$。

$b = \sum_{i=-n}^{m}2^i\times b_i$

### IEEE浮点表示

$V=(-1)^s\times M\times2^E$ 

s:符号位:  1 for 负数    0 for 正数

M:尾数:  一个二进制小数，范围是 1 ~ $2-\epsilon$（规格化） or 0 ~ $1-\epsilon$（非规格化）

E:阶码:  对浮点数进行加权，权重为2的E次幂

> 单精度、双精度浮点数的位级表示
>
> <img src="./note_img/float_pre.png" style="zoom:60%">

偏置Bias: $2^{k-1}-1$

> float: $2^7-1=127$
>
> double: $2^{10}-1=1023$

1. 规格化的值——exp的值既不是全0也不是全1

   阶码：$E = e - Bias$

   e的范围是1 ~ $2^8-2=254$（不能全是0），因此E的范围是-126 ~ 127 （以float为例）

   M=1+f

   > f为用二进制表示的小数 range: 1 ~ $2-\epsilon$

2. 非规格化——exp的值全是0

   阶码：$E = 1 - Bias$

   > -126 for single
   >
   > -1022 for double

   M=f

   > range: 0 ~ $1-\epsilon$

3. 特殊值——阶码全是1

   当 f 全为0时得到的值表示无穷

   f 非0时 表示"NAN(not a number)"

<img src="./note_img/float_range.png" style="zoom:50%">
